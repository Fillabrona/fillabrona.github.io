<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Quiz for Survival - Latest Download & Info</title>
    <link rel="icon" type="image/png" href="https://i.ibb.co/Xxrtbmmp/cropped-circle-image-3.png">
    
    <meta name="google-site-verification" content="MVor7wrlMLFwH8xrfTZFunQW4OTHCyqDeN5kt9ujt6E" />
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.1/dist/dotlottie-wc.js" type="module"></script>

    <script type="application/ld+json" id="game-data-json">
    {
        "@context": "https://schema.org",
        "@type": "VideoGame",
        "name": "Quiz for Survival",
        "applicationCategory": "TriviaGame",
        "softwareVersion": "v1.7.1",
        "description": "An intense trivia experience that challenges your knowledge, strategy, and risk management with over 2,500 questions across categories like General Knowledge, Sports, History, Games, Geography, Language, Music, Math, and Measurements. Each round features 10 randomly selected questions with four answer choices, but only one is correct, keeping every playthrough unpredictable. Correct answers award 10 points and 5 coins, while wrong answers reduce health by 10 and cost 3 coins, adding tension and strategy to every decision. After each round, the shop opens, letting you spend coins on Health Potions, Extra Lives, Mystery Boxes, Lucky Triples, and more, to enhance your survival chances. With four gameplay modes, Normal, Gauntlet, Shopless, and Multiplayer, and five difficulty levels Unlimited, Easy, Hard, Extreme, and Unbeatable, players can tailor the challenge to their skill. The game also features 15 achievements, a top-30 leaderboard, and an in-game feedback system for feedback & suggestions. When you reach the target score, a victory screen summarizes your performance, including final score, coins, health, completion time, correct and wrong answers, and a performance rating out of 100, giving a clear picture of how well you did. Combining knowledge, risk, and strategy, Quiz for Survival is an addictive, fast-paced trivia game that tests both your skill and endurance, rewarding careful play and quick thinking alike.",
        "changelog": [
			{ "version": "v1.7.1", "changes": ["Fixed the lobby loading animation to run smoothly, improved overall logic, patched several bugs, and added a few extra tweaks for better performance. A new review-sending option was also added, letting you submit your message along with your total hours played directly to the Fillabrona website."] },
            { "version": "v1.7.0", "changes": ["Multiplayer Mode has been added, letting you play and compete with friends, family, or anyone online, along with new sounds, improved visuals, and fixes for bugs and lag. And fixed some achievement logic, also topped it off with animations for victories and more.", "Added 5 new achievements, fixed animation replay issues, and introduced a secret reward for unlocking the 'Curiosity Pays' achievement. Improved the UI and added extra stats to the victory screen, including average performance rating, total correct and wrong answers, and more, along with various other tweaks."] },
            { "version": "v1.6.4", "changes": ["A new Achievements section has been added to the game, featuring new music tracks and 10 additional achievements to unlock. These new additions aim to make the game even more engaging and motivate players to actively pursue and earn achievements."] },
            { "version": "v1.6.3", "changes": ["A total of 1000 new questions have been added to enhance gameplay depth and a fully automated leaderboard has been introduced. Additionally, several new features have been introduced, along with various tweaks and bug fixes to improve overall performance and user experience."] },
            { "version": "v1.6.2", "changes": ["A new timed stat has been added, allowing you to track how long it took to reach the victory screen—a great way to challenge yourself and refine your skills. Minor user interface tweaks have also been implemented to improve readability and consistency across all devices. Additionally, several issues with the logic of certain tools have been fixed, ensuring they work as intended during gameplay."] },
            { "version": "v1.6.1", "changes": ["Tools in the shop were adjusted to be more cost-effective, with some tools receiving buffs while remaining reasonably priced. The Gauntlet Mode timer no longer glitches as frequently as it did in version 1.6.0. Additionally, some logic issues within the game were addressed, including the logic behind the Double Score Booster"] },
            { "version": "v1.6.0", "changes": ["A new tool has been added to the shop, featuring a completely redesigned UI. Two additional game modes have been introduced alongside the existing normal mode, now integrated with the “Gauntlet” and “Shopless” modes. The update also includes new features, extended music and sound options, UI enhancements, and a refresh button to easily reconnect to the internet"] },
            { "version": "v1.5.2", "changes": ["Fixed minor glitches and bugs, including issues with opening new screens and slow performance and newly redesigned rounded icon for a refreshed look"] },
            { "version": "v1.5.1", "changes": ["A feedback and suggestions feature has been added, allowing users to type a message and choose either \"suggestions\" or \"feedback.\" The input is then sent to Discord, where the developer can review it and potentially implement it into the game. New sounds have been added, and various flaws have been fixed"] },
            { "version": "v1.5.0", "changes": ["A new and improved user interface has been introduced, ensuring compatibility with all versions of Windows. Minor bugs, buffer issues, and glitches have been resolved, and resolution support has been optimized across all devices, including monitors and laptops"] },
            { "version": "v1.4.3", "changes": ["The game now requires an active internet connection for full functionality. This enables the leaderboard to update automatically and in real-time. Several flaws and glitches were fixed, and a few UI tweaks and new music implementations were added"] },
            { "version": "v1.4.2", "changes": ["Added a screenshot feature—double-clicking the quiz or victory screen now captures a shot of your wild scores, funny glitches, or memorable moments. Minor glitches were fixed, and a new “Unbeatable” difficulty was introduced, requiring a massive 5000 points to win. A new mystery item, “You Took My Score,” has been added to the Mystery Box, which deducts 20% of your current score if drawn"] },
            { "version": "v1.4.1", "changes": ["Added clickable links and UI tweaks, fixed visual bugs, and introduced the Mystery Box tool in the shop—a purchasable item with cool rewards to be won"] },
            { "version": "v1.4.0", "changes": ["Fully automated keyboard accessibility—no mouse needed—enhanced visuals and sounds, and fully functional difficulty settings (Easy, Hard, and Extreme) that trigger a victory screen when the target score is reached."] },
            { "version": "v1.3.3", "changes": ["The update notification now includes an expanded and more detailed visual design, along with a revamped startup menu that displays helpful tips and additional information"] },
            { "version": "v1.3.2", "changes": ["Added an update checker to notify users of new updates, along with bug fixes and UI adjustments"] },
            { "version": "v1.3.1", "changes": ["Two new tools added to the shop, along with 500 new questions, greatly expanding the depth of gameplay"] },
            { "version": "v1.3.0", "changes": ["A brand-new music track, and sound effects with an 8-bit retro vibe, UI enhancements in the leaderboard, bug fixes, and a new tool added to the shop"] },
            { "version": "v1.2.2", "changes": ["Nothing major, just some bug fixes and UI tweaks"] },
            { "version": "v1.2.1", "changes": ["Not much changed, just new players added to the leaderboard"] },
            { "version": "v1.2.0", "changes": ["New font implemented, leaderboard added, UI and in-game stats fixed, and total coins display updated in the shop"] },
            { "version": "v1.1.0", "changes": ["Resolved bugs, added new features, and introduced new tools for use"] },
            { "version": "v1.0.0", "changes": ["The game’s opening sequence, featuring all core functions and visual elements"] }
        ],
        "tools": [
            { "name": "Health Potion", "price": "10 Coins", "description": "Restores 25 Health points", "cooldown": "Null" },
            { "name": "Coin Boost", "price": "15 Coins", "description": "Gains 10 extra coins (Not a scam)", "cooldown": "Null" },
            { "name": "Skipper", "price": "20 Coins", "description": "Makes you skip any 3 questions you hesitate or don’t know the answer to", "cooldown": "Null" },
            { "name": "Mystery Box", "price": "30 Coins", "description": "Provides a random item. Lower-cost items have a higher chance of appearing, while higher-cost items are less likely to drop due to their rarity", "cooldown": "Null" },
            { "name": "Extra Life", "price": "35 Coins", "description": "Grants you a whole new life (100 Health points)", "cooldown": "Null" },
            { "name": "Shield", "price": "35 Coins", "description": "Blocks 5 wrong answers from losing money", "cooldown": "Null" },
            { "name": "Double Score Boost", "price": "45 Coins", "description": "Doubles the score from correct answers for the next 5 questions", "cooldown": "Null" },
            { "name": "50/50", "price": "60 Coins", "description": "Removes two wrong answers (usable 10 times)", "cooldown": "Null" },
            { "name": "Lucky Triples", "price": "65 Coins", "description": "Try to triple your coins or health, but risk losing a third.", "cooldown": "3 Min / 5 Min*" },
            { "name": "Double Score", "price": "70 Coins", "description": "Doubles your current score", "cooldown": "3 Min / 5 Min*" }
        ],
        "mysteryBox": [
            { "item": "More coins", "rarity": "Common", "howItWorks": "Adds 15 coins to your coins (Not a scam)" },
            { "item": "Health Booster", "rarity": "Common", "howItWorks": "Adds 50 Health points to your current Health points" },
            { "item": "Skips", "rarity": "Uncommon", "howItWorks": "Gives you 5 Skips to use" },
            { "item": "Shield", "rarity": "Uncommon", "howItWorks": "Activates shield once" },
            { "item": "You took my points!", "rarity": "Uncommon", "howItWorks": "Deducts 20% of your current score" },
            { "item": "Score Booster", "rarity": "Rare", "howItWorks": "Uses the formula (Health / Score) * 4 to calculate a multiplier, which is applied to the current Score. Capped and rounded for balance." },
            { "item": "Double Score", "rarity": "Super rare", "howItWorks": "Multiplies your current score by 2" }
        ],
        "luckyTriples": [
            { "item": "Coin Tripler", "chance": "40% Chance", "howItWorks": "Current coins are tripled" },
            { "item": "Health Tripler", "chance": "40% Chance", "howItWorks": "Current health is tripled" },
            { "item": "I’m Unlucky", "chance": "20% Chance", "howItWorks": "Coins and Health are multiplied by two-thirds, effectively losing one-third." }
        ],
        "difficulties": [
            { "name": "Unlimited", "score": "0", "description": "Goes on until you lose" },
            { "name": "Easy", "score": "250", "description": "Score of 250 needed to win" },
            { "name": "Hard", "score": "500", "description": "Score of 500 needed to win" },
            { "name": "Extreme", "score": "1000", "description": "Score of 1000 needed to win" },
            { "name": "Unbeatable", "score": "5000", "description": "Score of 5000 needed to win" }
        ],
        "modes": [
            { "name": "Normal", "icon": "fas fa-check-circle", "description": "Standard gameplay with the default settings" },
            { "name": "Gauntlet", "icon": "fas fa-hourglass-start", "description": "You have only 5 minutes to achieve the highest score you can" },
            { "name": "Shopless", "icon": "fas fa-ban", "description": "Play without a shop, rendering coins essentially worthless" },
            { "name": "Multiplayer", "icon": "fas fa-users", "description": "Play with friends online, and see who finishes first" }
        ],
        "achievements": [
            { "name": "Novice Survivor", "subtitle": "“Every survivor starts somewhere.”", "description": "Beat Easy difficulty", "icon": "fas fa-medal" },
            { "name": "Tough Challenger", "subtitle": "“You’ve proven you can handle the pressure.”", "description": "Beat Hard difficulty", "icon": "fas fa-shield-alt" },
            { "name": "Fearless Mind", "subtitle": "“You thrive where others crumble.”", "description": "Beat Extreme difficulty", "icon": "fa-solid fa-skull" },
            { "name": "Unstoppable", "subtitle": "“The trivia gods fear you now.”", "description": "Beat Unbeatable difficulty", "icon": "fas fa-crown" },
            { "name": "Master of Survival", "subtitle": "“From the first match to the final stand. You’ve done it all.”", "description": "Beat all difficulties at least once", "icon": "fas fa-star" },
            { "name": "Shopless Titan", "subtitle": "“Who needs items when you’ve got skill?”", "description": "Score more than 1,500 points in Shopless Mode", "icon": "fas fa-shopping-bag" },
            { "name": "Gauntlet Blitzer", "subtitle": "“Fast hands, faster mind.”", "description": "Score more than 1,500 points within 5 minutes in Gauntlet Mode", "icon": "fas fa-running" },
            { "name": "Curiosity Pays", "subtitle": "“You clicked where no one dared to click.”", "description": "Find the hidden easter egg", "icon": "fas fa-egg" },
            { "name": "Hall of Fame", "subtitle": "“Your name is now carved into survival history.”", "description": "Get onto the leaderboard", "icon": "fas fa-trophy" },
            { "name": "Broken Piggy Bank", "subtitle": "“You smashed that piggy bank wide open.”", "description": "Earn more than 200 coins in a single run", "icon": "fa-solid fa-money-bill" },
            { "name": "The Centurion", "subtitle": "“True endurance is rare.”", "description": "Answer 100 questions correctly in a single run", "icon": "fas fa-fire" },
            { "name": "Score Titan", "subtitle": "“Only the best of the best reach this level.”", "description": "Achieve a score of 10,000 in a single game", "icon": "fas fa-chart-line" },
            { "name": "The Shoplifter", "subtitle": "“Sometimes you spend big to win big.”", "description": "Purchase at least 15 items at the shop in a single run", "icon": "fas fa-cart-arrow-down" },
            { "name": "Perfect Time", "subtitle": "“Speed, accuracy, and efficiency.”", "description": "Get a score of at least 500 in under 2 minutes", "icon": "fas fa-stopwatch" },
            { "name": "Godlike Streak", "subtitle": "“An uninterrupted display of knowledge.”", "description": "Answer 25 questions in a row correctly", "icon": "fas fa-bolt" }
        ]
    }
    </script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Original main-bg
                        'main-bg': '#2b333e',  
                        // Muted Blue Accent: A slightly darker, less neon blue/cyan
                        'link-primary': '#04a4b0',  
                        // Muted Button Teal: A darker, more sophisticated teal
                        'button-primary': '#008C8C',  
                        // Glassmorphism base on the main-bg
                        'card-bg': 'rgba(43, 51, 62, 0.5)', // Slightly less transparent for less 'glassy' look
                    },
                    fontFamily: {
                        sans: ['Times New Roman', 'serif'], // Times New Roman
                    }
                }
            }
        }
    </script>
<style>
    /* 1. Base Styles and Scrollbar */
    body {
        background-color: #2b333e; /* Original color */
        color: white;
        transition: background-color 0.3s;
        font-family: 'Times New Roman', serif;
    }
    /* NEW: Class to disable scrolling on the body when a modal is open */
    .modal-open {
        overflow: hidden;
        /* Compensate for the scrollbar width (8px) to prevent content shift */
        padding-right: 8px; 
    }

    body::-webkit-scrollbar {
        width: 8px;
    }
    body::-webkit-scrollbar-thumb {
        /* FIX: Removed single quotes for color to work */
        background-color: #04a4b0; 
        border-radius: 4px;
    }

    /* 2. Sleek Glassmorphism (Less aggressive shadow/glow) */
    .card-glass {
        background: rgba(43, 51, 62, 0.5); /* Slightly darker/less transparent */
        backdrop-filter: blur(10px); /* Slightly less blur */
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1); /* CLEANER BORDER: Very subtle white border */
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4); /* Softer shadow */
        transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
    }
    /* ADDED: Subtle hover on card-glass for desktop/larger screens */
    @media (min-width: 768px) {
        .card-glass:hover {
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.5); /* Darker shadow */
            border-color: rgba(4, 164, 176, 0.4); /* Accent border pops */
            transform: translateY(-4px); /* A slightly stronger lift */
        }
    }
    
    /* NEW: Custom class for the *subtle* accent border on list items/secondary cards */
    .border-subtle-accent {
        border: 1px solid rgba(4, 164, 176, 0.2); /* Upped opacity from 0.1 to 0.2 */
    }

    /* 3. Hero Section (REDUCED HEIGHT) */
    .hero-background {
        width: 100%;
        min-height: 30vh; /* REDUCED from 50vh */
        position: absolute; 
        top: 0;
        left: 0;
        overflow: hidden;
        z-index: -3; 
    }
    .hero-background::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: url('https://i.ibb.co/DHf41tLP/0602-1.png');
        background-size: cover;
        background-position: center;
        filter: blur(5px) brightness(0.4); 
        transform: scale(1.05);
        z-index: -2;
        transition: transform 0.8s ease;
    }
    .hero-background::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to top, #2b333e 5%, transparent 60%);
        z-index: -1;
    }
    .hero-content-wrapper {
        min-height: 30vh; /* REDUCED from 50vh */
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative; 
    }

    /* 4. Navigation Bar (Muted Hover and Active State) */
    nav {
        z-index: 50;
    }
    .nav-link {
        transition: all 0.2s;
        padding: 0.75rem 1rem; 
        border-radius: 0.5rem; 
        display: flex;
        align-items: center;
        background: rgba(255, 255, 255, 0.05);
        flex-grow: 1; 
        justify-content: center;
        font-size: 1rem; 
        text-align: center; 
    }
    @media (min-width: 640px) { /* sm breakpoint */
        .nav-link {
            flex-grow: 0;
            font-size: 1.125rem; /* text-lg */
            justify-content: flex-start;
            text-align: left;
        }
    }

    .nav-link:hover {
        background: rgba(4, 164, 176, 0.2); /* Stronger background */
        color: white; /* Brighter text */
        transform: none; /* Removed transform */
        box-shadow: none; /* Removed shadow for a flatter, sleeker look */
    }
    .nav-link.active {
        color: white;
        background: #04a4b0; 
        box-shadow: 0 0 10px rgba(4, 164, 176, 0.4);
        transform: none; 
    }
    .nav-link.active i {
        color: #2b333e; 
    }

    /* NEW: CSS for Mobile Navigation Menu Animation */
    #nav-menu {
        max-height: 0;
        opacity: 0;
        overflow: hidden;
        transition: max-height 0.4s ease-out, opacity 0.4s ease-out, padding 0.4s ease-out;
    }
    #nav-menu.open {
        max-height: 500px; 
        opacity: 1;
        padding-top: 0.75rem; 
    }
    /* Revert the flex property on desktop */
    @media (min-width: 640px) { /* sm breakpoint */
        #nav-menu {
            max-height: none !important;
            opacity: 1 !important;
            overflow: visible !important;
            padding-top: 0 !important;
        }
    }

    /* 5. Smoother Changelog Accordion and Rotating Arrow (REVISED FOR SMOOTHNESS) */
/* 5. Smoother Changelog Accordion (REVISED FOR SMOOTHNESS) */
.changelog-entry {
    border-bottom: 1px solid rgba(255, 255, 255, 0.05); 
}

.changelog-header {
    cursor: pointer;
    /* REDUCED PADDING ON MOBILE */
    padding: 1rem; 
    transition: background-color 0.3s ease-in-out; 
    user-select: none;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
/* RESTORE PADDING ON LARGER SCREENS */
@media (min-width: 640px) {
    .changelog-header {
        padding: 1.5rem;
    }
}

.changelog-header:hover {
    background-color: rgba(255, 255, 255, 0.05);
}

.changelog-header i {
    /* Updated default color to #008C8C (button-primary) */
    color: #008C8C; 
    transition: transform 0.3s ease;
}

.changelog-header i.rotated {
    /* Updated rotated color to #008C8C */
    transform: rotate(180deg);
    color: #008C8C; /* Changed from #00c7d4 to #008C8C */
}

.changelog-content {
    /* CRITICAL for smooth slide effect */
    transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    overflow: hidden; 
}

/* Polishing the change blocks inside */
.changelog-change-block {
    background-color: rgba(255, 255, 255, 0.03); 
    border: 1px solid rgba(4, 164, 176, 0.1); 
    border-left: 5px solid #04a4b0; /* Accent border */
    /* ADDED: Reduced mobile padding on the change blocks */
    padding: 1rem; 
    margin-bottom: 0.5rem;
}
@media (min-width: 640px) {
    .changelog-change-block {
        padding: 1.5rem;
        margin-bottom: 1rem;
    }
}
    
    /* 6. Mobile adjustments for overall padding and flow */
    /* Reduce padding on the main content wrapper on small screens */
    /* Adjusted the original block to target the spacing more effectively */
    .main-wrapper {
        /* Default small padding and reduced space-y */
        padding: 1rem !important; 
        padding-top: 0 !important; 
        /* ADDED: Reduce spacing between sections on mobile */
        --tw-space-y-reverse: 0;
        margin-top: calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));
        margin-bottom: calc(1.5rem * var(--tw-space-y-reverse));
        
    }
    /* Restored original spacing on larger screens (sm:space-y-8) */
    @media (min-width: 640px) {
        .main-wrapper {
            padding: 2rem !important; /* sm:p-8 */
            padding-top: 0 !important; 
            --tw-space-y-reverse: 0;
            margin-top: calc(2rem * calc(1 - var(--tw-space-y-reverse)));
            margin-bottom: calc(2rem * var(--tw-space-y-reverse));
        }
    }


    /* 7. Specific Download Button Hover */
    #download-button:hover {
        background-color: white !important; /* Force white background on hover */
        color: #2b333e !important; /* Text color back to main-bg color for contrast */
    }

    /* 8. Fullscreen 404 Error Page - ENHANCED STYLING */
    #content-404 {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-color: #2b333e; /* Match main-bg */
        z-index: 100; /* Ensure it covers everything */
        display: none; /* Controlled by JS */
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
    }

	.lottie-404 {
		width: 100% !important; /* Forces the width to be 100% */
		max-width: 300px; 
		height: auto;
	}
    
    /* NEW: Lottie Security Enhancement */
    /* Prevents right-click, selection, and other pointer interactions on all Lottie elements */
    dotlottie-wc {
        user-select: none; /* Standard property */
        -moz-user-select: none; /* Firefox */
        -webkit-user-select: none; /* Safari/Chrome */
        -ms-user-select: none; /* IE/Edge */
        pointer-events: none; /* Disables all mouse events on the element */
        cursor: default; /* Ensures no hover cursor appears */
    }
    
    /* NEW: Mobile Font and Spacing Adjustments */
    @media (max-width: 639px) {
        /* Smaller font size for main text on mobile */
        .text-lg.text-start.md\:text-justify {
            font-size: 1.05rem; /* Slightly smaller than 1.125rem (text-lg) */
            line-height: 1.6;
        }
        /* Fix the justified text issue on mobile by forcing left alignment */
        .text-start {
            text-align: left !important;
        }
        
        /* Reduce card padding on small screens (original was p-6 sm:p-8) */
        .card-glass.p-6.sm\:p-8 {
            padding: 1.25rem !important; /* p-5 */
        }
    }

    /* --- NEW REVIEW SECTION STYLES --- */
    #reviews-loader {
        /* Tailwind classes for a centered spinner */
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 4rem 0;
        color: #04a4b0; /* link-primary */
    }

    .review-card {
        /* Using card-glass for consistency */
        background: rgba(43, 51, 62, 0.5);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        /* MODIFIED: Added accent border */
        border-left: 4px solid #04a4b0; 
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
        transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        /* MODIFIED: Moved padding and radius from JS to CSS */
        padding: 1.25rem; /* p-5 */
        border-radius: 0.75rem; /* rounded-xl */
    }

    /* NEW: Bubble for the review text */
    .review-text-bubble {
        background-color: rgba(0, 0, 0, 0.2);
        padding: 0.75rem 1rem;
        border-radius: 0.5rem; /* rounded-lg */
    }

    .like-button {
        background-color: rgba(4, 164, 176, 0.15); /* link-primary at 15% */
        color: #04a4b0; /* link-primary */
        border: 1px solid rgba(4, 164, 176, 0.3);
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        font-weight: 600;
        transition: all 0.2s ease-in-out;
        cursor: pointer;
    }

    .like-button:hover {
        background-color: #04a4b0; /* link-primary */
        color: #2b333e; /* main-bg */
        box-shadow: 0 0 10px rgba(4, 164, 176, 0.4);
    }
    
    /* MODIFIED: Updated disabled state for "liked" look */
    .like-button:disabled {
        background-color: #04a4b0; /* link-primary (filled) */
        color: #2b333e; /* main-bg (dark text) */
        opacity: 0.6; /* Make it look faded/inactive */
        cursor: not-allowed;
        border-color: transparent; /* Hide border */
        box-shadow: none; /* No shadow */
    }

    /* NEW: Rule to prevent hover effects when disabled */
    .like-button:disabled:hover {
        background-color: #04a4b0; /* Keep it the same as disabled */
        color: #2b333e; /* Keep it the same as disabled */
        opacity: 0.6; /* Keep it the same as disabled */
        box-shadow: none;
        transform: none;
    }

    /* NEW: Bubble for the playtime text */
    .playtime-bubble {
        background-color: rgba(4, 164, 176, 0.1);
        color: #04a4b0;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px; /* rounded-full */
        font-weight: 600;
    }
    
    /* === ADDED: NEW BUBBLE STYLES === */
    
    /* NEW: Info Bubble Style for Game Info & Tools */
    .info-bubble {
        background-color: rgba(0, 0, 0, 0.15); /* Dark, subtle bubble */
        border: 1px solid rgba(255, 255, 255, 0.05); /* Faint border */
        border-radius: 1rem; /* rounded-xl */
        padding: 1rem; /* p-4 */
        height: 100%; /* Make bubbles in a grid the same height */
        display: flex;
        flex-direction: column;
        transition: all 0.3s ease-in-out;
    }

    .info-bubble:hover {
        background-color: rgba(4, 164, 176, 0.1); /* Accent color bg */
        border-color: rgba(4, 164, 176, 0.4); /* Brighter accent border */
        transform: translateY(-2px); /* Slight lift */
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* Softer shadow on hover only */
    }

    /* Target the content inside the bubbles to ensure correct layout */
    .info-bubble h4 {
        color: #04a4b0; /* text-link-primary */
        font-weight: 700; /* bold */
        font-size: 1.125rem; /* text-lg */
    }
    
    /* Make sure description text pushes title up */
    .info-bubble .bubble-description {
        margin-top: auto; /* Pushes content down */
        padding-top: 0.5rem; /* space from title/subtitle */
        color: rgba(255, 255, 255, 0.8); /* text-white/80 */
        font-size: 0.875rem; /* text-sm */
    }
    
    .info-bubble .bubble-subtitle {
         color: rgba(255, 255, 255, 0.7); /* text-white/70 */
         font-size: 0.75rem; /* text-xs */
         font-style: italic;
         margin-bottom: 0.5rem; /* mb-2 */
    }
    
    /* Specific tweaks for different sections */
    
    /* Tools */
    .info-bubble.tool-bubble h4 {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        font-size: 1.25rem; /* text-xl */
    }
    .info-bubble.tool-bubble .tool-price {
        color: #008C8C; /* text-button-primary */
        font-weight: 600; /* semibold */
        font-size: 1.125rem; /* text-lg */
        margin-left: 1rem; /* ml-4 */
    }
    .info-bubble.tool-bubble .tool-cooldown {
        color: rgba(255, 255, 255, 0.6); /* text-white/60 */
        font-size: 0.75rem; /* text-xs */
        margin-top: 0.75rem; /* mt-3 */
    }

    /* Mystery Box / Lucky Triples */
    .info-bubble.reward-bubble h4 {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .info-bubble.reward-bubble .reward-rarity {
        font-size: 0.875rem; /* text-sm */
        font-weight: 400; /* normal */
        color: #008C8C; /* text-button-primary */
    }
    .info-bubble.reward-bubble .reward-rarity.super-rare {
        color: #04a4b0; /* text-link-primary */
        font-weight: 700; /* bold */
    }
    .info-bubble.reward-bubble .bubble-description {
         margin-top: 0.25rem; /* mt-1 */
    }
    
    /* Achievements */
    .info-bubble.achievement-bubble .achievement-header {
        display: flex;
        align-items: center;
        margin-bottom: 0.5rem; /* mb-2 */
    }
    .info-bubble.achievement-bubble .achievement-header i {
        color: #04a4b0; /* text-link-primary */
        margin-right: 0.75rem; /* mr-3 */
        font-size: 1.5rem; /* text-2xl */
        flex-shrink: 0;
    }
    .info-bubble.achievement-bubble .bubble-description {
         padding-top: 0; /* No extra padding needed */
    }

    /* Modes */
    .info-bubble.mode-bubble h4 {
        display: flex;
        align-items: center;
        font-size: 1.25rem; /* text-xl */
        color: #008C8C; /* text-button-primary */
        margin-bottom: 0.5rem; /* mb-2 */
    }
    .info-bubble.mode-bubble h4 i {
         margin-right: 0.75rem; /* mr-3 */
         color: #04a4b0; /* text-link-primary */
    }

    /* Difficulties */
    .info-bubble.difficulty-bubble h4 {
        font-size: 1.25rem; /* text-xl */
        color: #008C8C; /* text-button-primary */
        margin-bottom: 0.25rem; /* mb-1 */
    }
    .info-bubble.difficulty-bubble .difficulty-score {
        font-weight: 700; /* bold */
        color: #04a4b0; /* text-link-primary */
    }
    /* === END: NEW BUBBLE STYLES === */
    
    /* --- NEW FOOTER STYLES --- */
    #site-footer .card-glass {
        /* Prevent the footer from having hover effects that lift it */
        transform: none !important;
        border-top-left-radius: 1rem; /* rounded-t-xl */
        border-top-right-radius: 1rem; /* rounded-t-xl */
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
    }
    
    @media (min-width: 768px) {
        #site-footer .card-glass:hover {
            transform: none !important;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4); /* Keep original shadow */
            border-color: rgba(255, 255, 255, 0.1); /* Keep original border */
        }
    }

    .footer-link {
        color: rgba(255, 255, 255, 0.6);
        transition: all 0.3s ease;
    }

    .footer-link:hover {
        color: #04a4b0; /* link-primary */
        transform: scale(1.15) translateY(-2px);
    }
    /* --- END: NEW FOOTER STYLES --- */

</style>
</head>
<body class="min-h-screen">

<nav id="site-nav" class="sticky top-0 z-50 w-full p-4">
    <div class="max-w-5xl mx-auto p-2 rounded-xl shadow-2xl card-glass">
        <div class="flex justify-between items-center sm:hidden p-2">
            <h2 class="text-xl font-bold text-link-primary">Navigation</h2>
            <button id="menu-button" class="text-white/80 hover:text-white transition duration-200 p-1">
                <i id="menu-icon" class="fas fa-bars text-2xl"></i>
            </button>
        </div>

        <div id="nav-menu" class="sm:block">
            <div class="flex flex-col sm:flex-row gap-2 sm:gap-5 text-lg font-semibold text-white/80 pt-2 sm:pt-0 sm:justify-center">
                
                <a href="#section=home" class="nav-link active flex-1" data-section="home">
                    <i class="fas fa-home mr-2 text-link-primary transition-colors duration-200"></i>Home
                </a>

                <a href="#section=reviews" class="nav-link flex-1 text-base sm:text-lg" data-section="reviews">
                    <i class="fas fa-star mr-2 text-link-primary transition-colors duration-200"></i>Reviews
                </a>

                <a href="#section=about" class="nav-link flex-1 text-base sm:text-lg" data-section="about">
                    <i class="fas fa-toolbox mr-2 text-link-primary transition-colors duration-200"></i>Tools & Logic
                </a>
                <a href="#section=changelog" class="nav-link flex-1 text-base sm:text-lg" data-section="changelog">
                    <i class="fas fa-code-branch mr-2 text-link-primary transition-colors duration-200"></i>Update Log
                </a>

                <a href="#section=database" class="nav-link flex-1 text-base sm:text-lg" data-section="database">
                    <i class="fas fa-database mr-2 text-link-primary transition-colors duration-200"></i>Game Info
                </a>
                
            </div>
        </div>
    </div>
</nav>


    <div class="hero-background"></div>

    <div id="download-modal-backdrop" class="fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center transition-opacity duration-300 opacity-0 pointer-events-none">
        <div id="download-modal-content" class="bg-card-bg p-6 sm:p-8 rounded-2xl shadow-2xl max-w-sm w-11/12 transform scale-90 transition-all duration-300 relative border-2 border-link-primary/50 card-glass">

            <button id="modal-close-button" class="absolute top-3 right-3 text-white/50 hover:text-white transition duration-200">
                <i class="fas fa-times-circle text-2xl"></i>
            </button>

            <div class="flex flex-col items-center text-center space-y-4">
                <dotlottie-wc
                    src="https://lottie.host/be23f1e0-b091-46b7-8a08-ae79a6f4bb51/KAzxaEOB4s.lottie"
                    style="width: 300px;"
                    autoplay loop>
                </dotlottie-wc>

                <h3 class="text-3xl font-bold text-link-primary">Download Initiated!</h3>
                <p id="modal-message" class="text-white/80 text-lg">
                    The automatic download for version <b>${versionNumber}</b> is starting now. Check your browser's download folder.
                </p>

                <button onclick="document.getElementById('modal-close-button').click()"
                    class="mt-4 w-full px-6 py-3 text-lg font-semibold text-main-bg bg-button-primary rounded-xl transition duration-300 hover:bg-opacity-80 active:scale-95 shadow-lg">
                    <i class="fas fa-thumbs-up mr-2"></i> Got It
                </button>
            </div>
        </div>
    </div>
    
    <div id="welcome-modal-backdrop" class="fixed inset-0 bg-black bg-opacity-90 z-[60] flex items-center justify-center transition-opacity duration-300 opacity-0 pointer-events-none">
        <div id="welcome-modal-content" class="bg-card-bg p-6 sm:p-8 rounded-2xl shadow-2xl max-w-sm w-11/12 transform scale-90 transition-all duration-300 relative border-2 border-link-primary/50 card-glass">

            <div class="flex flex-col items-center text-center space-y-4">
                
                <dotlottie-wc
                    src="https://lottie.host/99429067-13da-4230-aadd-6a64a320efdd/afkbdvOdwj.lottie"
                    style="width: 600px;" class="max-w-full mx-auto" autoplay loop>
                </dotlottie-wc>
                <h3 class="text-3xl font-bold text-link-primary">Quiz for Survival</h3>
                <p class="text-white/80 text-lg">
                    The latest version is available! Would you like to start the download now?
                </p>

                <button id="welcome-download-button"
                    class="mt-4 w-full px-6 py-3 text-lg font-semibold text-main-bg bg-button-primary rounded-xl transition duration-300 hover:bg-opacity-80 active:scale-95 shadow-lg animate-pulse hover:animate-none">
                    <i class="fas fa-cog fa-spin mr-2"></i> Initializing...
                </button>

                <button id="welcome-continue-button"
                    class="w-full px-6 py-3 text-lg font-semibold text-white/70 hover:text-white transition duration-300 border border-white/30 rounded-xl hover:bg-white/10 active:scale-95">
                    <i class="fas fa-arrow-right mr-2"></i> Continue to Website
                </button>
            </div>
        </div>
    </div>


    <header id="site-header" class="hero-content-wrapper">
        <div class="text-center p-8 z-10 max-w-5xl mx-auto">
            <h1 id="hero-title" class="text-5xl sm:text-7xl font-extrabold tracking-tight text-white mb-4">
                Quiz for Survival
            </h1>
            <p id="hero-subtitle" class="text-xl sm:text-3xl text-link-primary font-light tracking-wider">
                The ultimate trivia experience of knowledge, strategy, and survival.
            </p>
        </div>
    </header>
    
    <div id="main-page-wrapper" class="max-w-6xl mx-auto space-y-6 sm:space-y-8 p-4 sm:p-8 pt-0 main-wrapper">

        <main id="main-content" class="space-y-6 sm:space-y-8">

            <section id="content-home" class="content-section space-y-6 sm:space-y-8">
                
                <div class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">
                    <h2 class="text-2xl sm:text-3xl font-bold text-link-primary border-b border-link-primary/50 pb-4 flex items-center">
                        <i class="fas fa-book-open mr-3 text-2xl"></i> About the Game
                    </h2>
                    <p class="text-white/90 leading-relaxed text-lg text-start md:text-justify">
						<span class="font-bold text-link-primary">
							<a href="https://fillabrona.itch.io/quiz-for-survival" target="_blank">Quiz for Survival</a>
						</span> is an intense trivia experience that challenges your knowledge, strategy, and risk management with over 2,500 questions across categories like General Knowledge, Sports, History, Games, Geography, Language, Music, Math, and Measurements. Each round features 10 randomly selected questions with four answer choices, but only one is correct, keeping every playthrough unpredictable. Correct answers award 10 points and 5 coins, while wrong answers reduce health by 10 and cost 3 coins, adding tension and strategy to every decision. After each round, the shop opens, letting you spend coins on Health Potions, Extra Lives, Mystery Boxes, Lucky Triples, and more, to enhance your survival chances. With four gameplay modes, Normal, Gauntlet, Shopless, and Multiplayer, and five difficulty levels Unlimited, Easy, Hard, Extreme, and Unbeatable, players can tailor the challenge to their skill. The game also features 15 achievements, a top-30 leaderboard, and an in-game feedback system for feedback & suggestions. When you reach the target score, a victory screen summarizes your performance, including final score, coins, health, completion time, correct and wrong answers, and a performance rating out of 100, giving a clear picture of how well you did. Combining knowledge, risk, and strategy, Quiz for Survival is an addictive, fast-paced trivia game that tests both your skill and endurance, rewarding careful play and quick thinking alike.
					</p>
                </div>

                <div id="latest-version-card" class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">

                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between border-b border-button-primary/50 pb-4">
                        <h2 id="latest-version-heading" class="text-2xl sm:text-3xl font-bold text-button-primary flex items-center mb-2 sm:mb-0">
                            <i class="fas fa-spinner fa-spin mr-3 text-2xl"></i> Loading Update Info...
                        </h2>
                        <div id="latest-version-meta" class="text-right flex flex-col items-end space-y-0 pt-2 sm:pt-0">
                            <p class="text-2xl font-bold text-white" id="version-display">Loading...</p>
                            <p class="text-white/70 text-xs" id="author-info">by...</p>
                        </div>
                    </div>

                    <div id="latest-version-content" class="min-h-[100px]">
                        <div id="version-placeholder" class="space-y-4 animate-pulse">
                            <div class="h-5 bg-gray-600 rounded w-1/4"></div>
                            <div class="space-y-2 pl-6">
                                <div class="h-4 bg-gray-700 rounded w-full"></div>
                                <div class="h-4 bg-gray-700 rounded w-5/6"></div>
                            </div>
                        </div>
                    </div>

                    <div id="file-stats-wrapper" class="pt-4">
                        
                        <div id="file-stats-placeholder" class="flex justify-center space-x-8">
                            <div class="flex flex-col items-start w-24">
                                <div class="h-3 bg-gray-600 rounded w-1/2 animate-pulse mb-1"></div>
                                <div class="h-4 bg-gray-700 rounded w-full animate-pulse"></div>
                            </div>
                            <div class="flex flex-col items-start w-24">
                                <div class="h-3 bg-gray-600 rounded w-1/2 animate-pulse mb-1"></div>
                                <div class="h-4 bg-gray-700 rounded w-full animate-pulse"></div>
                            </div>
                        </div>
                        
                        <div id="file-stats-content" class="hidden flex justify-center space-x-8">
                            <div class="flex items-center">
                                <i class="fas fa-file-archive text-white/40 text-base mr-2 flex-shrink-0"></i>
                                <div class="flex flex-col text-left">
                                    <p class="text-white/70 text-xs font-semibold leading-none">File Size</p>
                                    <p id="file-size-value" class="text-white/90 font-normal text-sm leading-none pt-0.5">...</p>
                                </div>
                            </div>

                            <div class="flex items-center">
                                <i class="fas fa-chart-line text-white/40 text-base mr-2 flex-shrink-0"></i>
                                <div class="flex flex-col text-left">
                                    <p class="text-white/70 text-xs font-semibold leading-none">Total Downloads</p>
                                    <p id="download-count-value" class="text-white/90 font-normal text-sm leading-none pt-0.5">...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="pt-6 flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-8">
                        <button id="download-button"
                            class="w-11/12 sm:w-auto px-12 py-4 text-xl font-bold text-main-bg uppercase transition duration-300 transform bg-link-primary rounded-xl shadow-lg hover:shadow-xl hover:bg-link-primary/90 active:scale-95 disabled:opacity-50 tracking-wider">
                            <i class="fas fa-cog fa-spin mr-2"></i> Initializing...
                        </button>
                    </div>
                </div>

                <div class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">
                    <h2 class="text-2xl sm:text-3xl font-bold text-link-primary border-b border-link-primary/50 pb-4 flex items-center">
                        <i class="fas fa-rocket mr-3 text-2xl"></i> Upcoming Features
                    </h2 >
                    <div id="whats-next-content" class="min-h-[100px]">
                        <div id="roadmap-placeholder" class="space-y-4 animate-pulse">
                             <div class="h-5 bg-gray-600 rounded w-1/3"></div>
                            <div class="space-y-2 pl-6">
                                <div class="h-4 bg-gray-700 rounded w-full"></div>
                                <div class="h-4 bg-gray-700 rounded w-5/6"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="content-reviews" class="content-section space-y-6 sm:space-y-8 hidden">
                <div class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">
                    <h3 class="text-2xl sm:text-3xl font-bold text-button-primary border-b border-button-primary/50 pb-3 flex items-center">
                        <i class="fas fa-star-half-alt mr-3 text-2xl"></i> Player Reviews
                    </h3>
                    <div class="bg-main-bg/50 border border-link-primary/30 p-4 rounded-lg flex items-center space-x-3 text-white/80">
						<i class="fa-solid fa-circle-info text-link-primary text-xl"></i>
						<span>Reviews can only be sent from the game itself, not the website.</span>
					</div>
                    <div id="reviews-loader" class="flex items-center justify-center p-12">
                        <i class="fas fa-spinner fa-spin text-4xl text-link-primary"></i>
                        <span class="ml-4 text-2xl text-white/80">Loading Reviews...</span>
                    </div>
                    <div id="reviews-container" class="space-y-6">
                        </div>
                </div>
            </section>

            <section id="content-about" class="content-section space-y-6 sm:space-y-8 hidden">
                <div class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">
                    <h3 class="text-2xl sm:text-3xl font-bold text-button-primary border-b border-button-primary/50 pb-3 flex items-center">
                        <i class="fas fa-toolbox mr-3 text-2xl"></i> Shop Tools
                    </h3>
                    <div id="tools-content" class="grid md:grid-cols-2 gap-4 sm:gap-6">
                        </div>
                </div>

                <div class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">
                    <h3 class="text-2xl sm:text-3xl font-bold text-button-primary border-b border-button-primary/50 pb-3 flex items-center">
                        <i class="fas fa-box-open mr-3 text-2xl"></i> Mystery Box Rewards & Mechanics
                    </h3>
                    <div id="mystery-box-content" class="space-y-4">
                        </div>
                </div>

                <div class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">
                    <h3 class="text-2xl sm:text-3xl font-bold text-button-primary border-b border-button-primary/50 pb-3 flex items-center">
                        <i class="fas fa-dice-three mr-3 text-2xl"></i> Lucky Triples Rewards
                    </h3>
                    <div id="lucky-triples-content" class="space-y-4">
                        </div>
                </div>
            </section>

            <section id="content-changelog" class="content-section space-y-6 sm:space-y-8 hidden">
                <div class="card-glass p-0 rounded-2xl shadow-xl overflow-hidden">
                    <div id="changelog-content">
                        </div>
                </div>
            </section>

            <section id="content-database" class="content-section space-y-6 sm:space-y-8 hidden">
                <div class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">
                    <h3 class="text-2xl sm:text-3xl font-bold text-button-primary border-b border-button-primary/50 pb-3 flex items-center">
                        <i class="fas fa-gamepad mr-3 text-2xl"></i> Game Modes
                    </h3>
                    <div id="modes-content" class="grid md:grid-cols-2 gap-4 sm:gap-6">
                        </div>
                </div>

                <div class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">
                    <h3 class="text-2xl sm:text-3xl font-bold text-button-primary border-b border-button-primary/50 pb-3 flex items-center">
                        <i class="fas fa-brain mr-3 text-2xl"></i> Difficulty Levels
                    </h3>
                    <div id="difficulties-content" class="grid md:grid-cols-2 gap-4 sm:gap-6">
                        </div>
                </div>

                <div class="card-glass p-6 sm:p-8 rounded-2xl shadow-xl space-y-6">
                    <h3 class="text-2xl sm:text-3xl font-bold text-button-primary border-b border-button-primary/50 pb-3 flex items-center">
                        <i class="fas fa-trophy mr-3 text-2xl"></i> All Achievements
                    </h3>
                    <div id="achievements-content" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                        </div>
                </div>
            </section>

        </main>
    </div>
    
<section id="content-404" class="hidden fixed inset-0 flex items-center justify-center z-50 p-4">
    <div class="flex flex-col items-center">
        <dotlottie-wc id="lottie-404" class="lottie-404 mx-auto mb-8" autoplay loop
            src="https://lottie.host/47ace394-5c3b-4f9b-b3fc-b6a2e0514288/IFwzZgHc8T.lottie"
            style="width: 300px;">
        </dotlottie-wc>
        <h3 class="text-3xl sm:text-4xl font-bold text-white mb-6 mt-[-1rem]">Page Not Found</h3>

        <p class="text-xl text-white/80 mb-10 max-w-sm text-center">
            It looks like the link you followed doesn't exist here. Time to head back to the quiz!
        </p>

        <a href="#section=home" id="404-home-link"
            class="inline-block px-10 py-3 text-xl font-semibold text-main-bg bg-button-primary rounded-xl transition duration-300 hover:bg-opacity-80 active:scale-95 shadow-lg">
            <i class="fas fa-arrow-left mr-2"></i> Go to Home
        </a>
    </div>
</section>

    <!-- NEW FOOTER SECTION -->
    <footer id="site-footer" class="mt-auto">
        <div class="max-w-5xl mx-auto px-4 sm:px-2">
            <div class="p-6 sm:p-8">
                <div class="flex flex-col md:flex-row justify-between items-center text-center md:text-left space-y-6 md:space-y-0">
                    
                    <!-- Left Section: Copyright -->
                    <div class="flex-1">
                        <h4 class="text-lg font-bold text-link-primary mb-1">Quiz for Survival</h4>
                        <p class="text-sm text-white/60">&copy; 2025 Fillabrona. All Rights Reserved.</p>
                    </div>

                    <!-- Center Section: Social Links -->
                    <div class="flex-1 flex justify-center items-center space-x-8">
                        <a href="https://fillabrona.itch.io/quiz-for-survival" target="_blank" class="footer-link" aria-label="itch.io Page">
                            <i class="fab fa-itch-io text-3xl"></i>
                        </a>
                        <a href="https://www.youtube.com/@FillabronaOfficial" target="_blank" class="footer-link" aria-label="YouTube Channel">
                            <i class="fab fa-youtube text-3xl"></i>
                        </a>
                        <a href="https://discord.gg/8N3W6dJzbn" target="_blank" class="footer-link" aria-label="Discord Server">
                            <i class="fab fa-discord text-3xl"></i>
                        </a>
                    </div>
                    
                    <!-- Right Section: Developer Credit -->
                    <div class="flex-1 text-center md:text-right">
                         <p class="text-sm text-white/50">Game by Fillabrona</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- END: NEW FOOTER SECTION -->


    <script type="module">
        // --- FIREBASE IMPORTS ---
        // Original Firestore imports (for download counter)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        
        // *** FIX: Corrected import for getAuth, signInAnonymously, signInWithCustomToken ***
        // The typo "_from" is now "from"
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        import { 
            getFirestore, doc, onSnapshot, updateDoc, increment, setDoc, Transaction, runTransaction, 
            getDoc, collection, getDocs, setLogLevel
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // NEW: Realtime Database imports (for reviews)
        import { 
            getDatabase, 
            ref, 
            onValue, 
            runTransaction as rtdbRunTransaction, // Rename to avoid conflict
            query, 
            orderByChild 
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-database.js";

        // --- FIREBASE CONFIGURATION ---
        
        // 1. Original config for Firestore Download Counter (from your file)
        const FIRESTORE_DOWNLOAD_CONFIG = {
            apiKey: "AIzaSyCAmYCabtz0apNHmyw9w6Jlr2lPpyXDUKk", 
            authDomain: "downlodsqfs.firebaseapp.com",
            projectId: "downlodsqfs",
            storageBucket: "downlodsqfs.firebasestorage.app",
            messagingSenderId: "597637748461",
            appId: "1:597637748461:web:a24eb0794427a38aa11ee4",
            measurementId: "G-1FWDCC5GH4" 
        };

        // 2. NEW config for RTDB Reviews (from your prompt)
        const RTDB_REVIEW_CONFIG = {
            apiKey: "AIzaSyC46EyePwg6oytVGDOeNg_F1xtHaLLN_KI",
            authDomain: "quizforsurvival.firebaseapp.com",
            databaseURL: "https://quizforsurvival-default-rtdb.firebaseio.com",
            projectId: "quizforsurvival",
            storageBucket: "quizforsurvival.firebasestorage.app",
            messagingSenderId: "493584571443",
            appId: "1:493584571443:web:6438fb679c04699a4dd746",
            measurementId: "G-HN1S70HQHS"
        };


        // Canvas environment variables for ID and Auth (for download counter)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        // Firestore (Download Count) App
        let fsDb = null;
        let fsAuth = null;
        let downloadCounterRef = null;

        // RTDB (Reviews) App
        let rtdb = null;
        let reviewsRef = null;
        const likedReviewsKey = 'qfs_liked_reviews';

        // --- FIREBASE INITIALIZATION AND AUTHENTICATION ---
        const initializeFirebase = async () => {
            try {
                // 1. Initialize Firestore App (for downloads)
                const fsApp = initializeApp(FIRESTORE_DOWNLOAD_CONFIG, "downloadApp");
                fsDb = getFirestore(fsApp);
                fsAuth = getAuth(fsApp);
                
                if (initialAuthToken) {
                    await signInWithCustomToken(fsAuth, initialAuthToken);
                } else {
                    await signInAnonymously(fsAuth);
                }
                
                downloadCounterRef = doc(fsDb, 'artifacts', appId, 'public', 'data', 'qfs_downloads', 'counter');
                
                const counterSnap = await getDoc(downloadCounterRef);
                if (!counterSnap.exists()) {
                    await setDoc(downloadCounterRef, { count: 0 });
                }
                console.log("Firestore (Downloads) initialized and authenticated.");

                // 2. Initialize RTDB App (for reviews)
                // We give it a unique name to co-exist
                const rtdbApp = initializeApp(RTDB_REVIEW_CONFIG, "reviewApp");
                rtdb = getDatabase(rtdbApp);
                reviewsRef = ref(rtdb, 'reviews');
                console.log("Realtime Database (Reviews) initialized.");

            } catch (error) {
                console.error("Firebase initialization failed:", error);
            }
        };

        // --- FIRESTORE LOGIC (Download Counter - Unchanged) ---
        const startDownloadListener = () => {
            if (!downloadCounterRef) return;
			const abbreviateNumber = (num) => {
				if (num === null || num === undefined) { return '0'; }
				return new Intl.NumberFormat('en-US', {
					notation: 'compact',
					maximumFractionDigits: 1
				}).format(num);
			};
			onSnapshot(downloadCounterRef, (doc) => {
				const count = doc.exists() ? doc.data().count : 0;
				document.getElementById('download-count-value').textContent = abbreviateNumber(count);
			}, (error) => {
				console.error("Error listening to download count:", error);
				document.getElementById('download-count-value').textContent = 'Error';
			});
        };

        const incrementDownloadCount = async () => {
            if (!downloadCounterRef) {
                console.error("Download Counter Ref is not initialized.");
                return;
            }
            try {
                await runTransaction(fsDb, async (transaction) => {
                    const sfDoc = await transaction.get(downloadCounterRef);
                    if (!sfDoc.exists()) {
                        transaction.set(downloadCounterRef, { count: 1 });
                    } else {
                        transaction.update(downloadCounterRef, { count: increment(1) });
                    }
                });
                console.log("Download count incremented successfully.");
            } catch (error) {
                console.error("Transaction failed to increment download count:", error);
            }
        };


        // --- NEW: REALTIME DATABASE LOGIC (Reviews) ---

        /**
         * Loads and displays reviews from the Realtime Database.
         */
        const startReviewListener = () => {
            if (!reviewsRef) return;

            const reviewsLoader = document.getElementById('reviews-loader');
            const reviewsContainer = document.getElementById('reviews-container');
            
            // Query to get reviews, ordered by timestamp (newest first)
            const reviewsQuery = query(reviewsRef, orderByChild('timestamp'));

            onValue(reviewsQuery, (snapshot) => {
                // *** FIX: Add null check for reviewsContainer ***
                if (!reviewsContainer) return; 
                reviewsContainer.innerHTML = ''; // Clear old reviews
                
                if (!snapshot.exists()) {
                    reviewsContainer.innerHTML = '<p class="text-white/70 text-center">No reviews yet. Be the first to leave one from the game!</p>';
                    // *** FIX: Add null check for reviewsLoader ***
                    if (reviewsLoader) reviewsLoader.style.display = 'none';
                    return;
                }

                const reviews = [];
                snapshot.forEach((childSnapshot) => {
                    // RTDB returns items in ascending order, so we unshift to reverse
                    reviews.unshift({
                        id: childSnapshot.key,
                        ...childSnapshot.val()
                    });
                });

                // Get liked reviews from local storage
                const likedReviews = getLikedReviews();

                reviews.forEach(review => {
                    const cardHtml = createReviewCard(review, likedReviews.includes(review.id));
                    reviewsContainer.insertAdjacentHTML('beforeend', cardHtml);
                });

                if (reviewsLoader) reviewsLoader.style.display = 'none';

            }, (error) => {
                console.error("Error loading reviews:", error);
                if (reviewsContainer) {
                    reviewsContainer.innerHTML = '<p class="text-red-400 text-center">Error loading reviews. Please try refreshing.</p>';
                }
                if (reviewsLoader) reviewsLoader.style.display = 'none';
            });
        };

        /**
         * Creates the HTML for a single review card.
         * @param {object} review - The review data.
         * @param {boolean} hasLiked - If the user has liked this review in this session.
         */
        const createReviewCard = (review, hasLiked) => {
            const date = new Date(review.timestamp * 1000);
            const formattedDate = date.toLocaleDateString('en-US', {
                year: 'numeric', month: 'short', day: 'numeric'
            });

            // Make sure reviewText is treated as text and not HTML
            const textEl = document.createElement('p');
            textEl.className = 'review-text-bubble text-white/90 text-md leading-relaxed whitespace-pre-wrap';
            textEl.textContent = review.reviewText;

            // *** FIX: Ensure review.likes exists or default to 0 ***
            const likeCount = review.likes || 0;

            // MODIFIED: Removed p-5 and rounded-xl from div, as they are now in .review-card CSS
            return `
                <div class="review-card space-y-4">
                    <div class="flex justify-between items-center border-b border-link-primary/30 pb-3">
                        <h4 class="text-xl font-bold text-link-primary">${review.userName || 'Anonymous'}</h4>
                        <span class="text-sm text-white/60">${formattedDate}</span>
                    </div>
                    
                    ${textEl.outerHTML} 
                    
                    <div class="flex justify-between items-center pt-3">
                        <span class="playtime-bubble text-sm italic">Playtime: ${(review.playtimeHours || 0).toFixed(1)} hours</span>
                        <button 
                            class="like-button" 
                            data-review-id="${review.id}"
                            ${hasLiked ? 'disabled' : ''}>
                            <i class="fas fa-thumbs-up mr-2"></i> 
                            ${hasLiked ? 'Liked' : 'Helpful'} (${likeCount})
                        </button>
                    </div>
                </div>
            `;
        };

        /**
         * Increments the 'likes' count for a review using a transaction.
         * @param {string} reviewId - The ID of the review to like.
         */
        const incrementReviewLike = (reviewId) => {
            if (!rtdb) return;

            const button = document.querySelector(`button[data-review-id="${reviewId}"]`);
            if (!button || button.disabled) return;

            // --- FIX FOR SPAM CLICK (RACE CONDITION) ---
            // 1. Disable button immediately
            button.disabled = true;
            // 2. Add to local storage *immediately*. This ensures that if the
            //    onValue listener re-renders the page, the button will
            //    *still* be rendered as 'disabled' (because hasLiked will be true).
            addLikedReview(reviewId);
            // 3. Update text
            button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Liking...';

            const likeRef = ref(rtdb, `reviews/${reviewId}/likes`);
            
            rtdbRunTransaction(likeRef, (currentLikes) => {
                if (currentLikes === null) {
                    return 1; // It was null or 0, set to 1
                }
                return currentLikes + 1;
            }).then(() => {
                console.log("Like transaction successful.");
                // The onValue listener will automatically update the UI with the new count.
                // We already added to local storage, so we're done here.
            }).catch((error) => {
                console.error("Like transaction failed: ", error);
                
                // If it fails (e.g., security rules), roll back:
                // 1. Remove from local storage so the user can try again.
                removeLikedReview(reviewId); 
                
                // 2. Re-enable the button *if it still exists*.
                //    (The onValue listener might have re-rendered, so we query again)
                const currentButton = document.querySelector(`button[data-review-id="${reviewId}"]`);
                if(currentButton) {
                    currentButton.disabled = false;
                    currentButton.innerHTML = '<i class="fas fa-thumbs-up mr-2"></i> Helpful (Error)';
                }
            });
        };

        /**
         * Gets the list of liked review IDs from local storage.
         */
        const getLikedReviews = () => {
            try {
                return JSON.parse(localStorage.getItem(likedReviewsKey) || '[]');
            } catch (e) {
                console.error("Error parsing liked reviews from localStorage", e);
                return []; // Return empty array on error
            }
        };

        /**
         * Adds a review ID to the liked list in local storage.
         * @param {string} reviewId
         */
        const addLikedReview = (reviewId) => {
            const likedReviews = getLikedReviews();
            if (!likedReviews.includes(reviewId)) {
                likedReviews.push(reviewId);
                try {
                    localStorage.setItem(likedReviewsKey, JSON.stringify(likedReviews));
                } catch (e) {
                    console.error("Error saving liked reviews to localStorage", e);
                }
            }
        };

        /**
         * (NEW) Removes a review ID from the liked list in local storage.
         * Used for rolling back a failed transaction.
         * @param {string} reviewId
         */
        const removeLikedReview = (reviewId) => {
            let likedReviews = getLikedReviews();
            if (likedReviews.includes(reviewId)) {
                likedReviews = likedReviews.filter(id => id !== reviewId);
                try {
                    localStorage.setItem(likedReviewsKey, JSON.stringify(likedReviews));
                } catch (e) {
                    console.error("Error removing liked review from localStorage", e);
                }
            }
        };


        // --- MAIN APP LOGIC ---
        document.addEventListener('DOMContentLoaded', () => {
            const URLS = {
                // Using the newer Gist URL from the second script
                masterData: 'https://gist.githubusercontent.com/Fillabrona/5a17fe172177f74a4a65196ba1b53c50/raw/523059da8e38714ffd789d6c63c9e2b3f5d1d92b/downloadinfo',
            };
			
            const LOTTIE_404_URL = 'https://lottie.host/47ace394-5c3b-4f9b-b3fc-b6a2e0514288/IFwzZgHc8T.lottie';

            const SELECTORS = {
                pageTitle: document.getElementById('page-title'),
                mainContent: document.getElementById('main-content'),
                navLinks: document.querySelectorAll('.nav-link'),
                latestVersionHeading: document.getElementById('latest-version-heading'),
                downloadButton: document.getElementById('download-button'),
                versionContentDiv: document.getElementById('latest-version-content'),
                versionMetaDiv: document.getElementById('latest-version-meta'),
                whatsNextDiv: document.getElementById('whats-next-content'),
                
                modalBackdrop: document.getElementById('download-modal-backdrop'),
                modalContent: document.getElementById('download-modal-content'),
                modalCloseButton: document.getElementById('modal-close-button'),
                modalMessage: document.getElementById('modal-message'),
                
                welcomeModalBackdrop: document.getElementById('welcome-modal-backdrop'),
                welcomeModalContent: document.getElementById('welcome-modal-content'),
                welcomeDownloadButton: document.getElementById('welcome-download-button'),
                welcomeContinueButton: document.getElementById('welcome-continue-button'),

                // Content Sections
                contentHome: document.getElementById('content-home'),
                contentReviews: document.getElementById('content-reviews'), // NEW
                contentAbout: document.getElementById('content-about'),
                contentChangelog: document.getElementById('content-changelog'),
                contentDatabase: document.getElementById('content-database'),
                content404: document.getElementById('content-404'),
                
                // Dynamic Content Holders
                toolsContent: document.getElementById('tools-content'),
                mysteryBoxContent: document.getElementById('mystery-box-content'),
                luckyTriplesContent: document.getElementById('lucky-triples-content'),
                modesContent: document.getElementById('modes-content'),
                difficultiesContent: document.getElementById('difficulties-content'),
                achievementsContent: document.getElementById('achievements-content'),

                heroTitle: document.getElementById('hero-title'),
                heroSubtitle: document.getElementById('hero-subtitle'),

                menuButton: document.getElementById('menu-button'),
                navMenu: document.getElementById('nav-menu'),
                menuIcon: document.getElementById('menu-icon'),
                siteNav: document.getElementById('site-nav'),
                siteHeader: document.getElementById('site-header'),
                mainPageWrapper: document.getElementById('main-page-wrapper'),

                versionDisplay: document.getElementById('version-display'),
                authorInfo: document.getElementById('author-info'),
                fileSizeValue: document.getElementById('file-size-value'),
                downloadCountValue: document.getElementById('download-count-value'),

                fileStatsPlaceholder: document.getElementById('file-stats-placeholder'),
                fileStatsContent: document.getElementById('file-stats-content'),

                lottie404: document.getElementById('lottie-404'),
                homeLink404: document.getElementById('404-home-link'),
            };

            // MODIFIED: List of all valid content sections
            const VALID_SECTIONS = ['home', 'reviews', 'about', 'changelog', 'database'];

            // MODIFIED: Section titles
            const SECTION_TITLES = {
                'home': { title: 'Quiz for Survival', subtitle: 'The ultimate trivia experience of knowledge, strategy, and survival.' },
                'reviews': { title: 'Player Reviews', subtitle: 'See what players are saying about the game.' }, // NEW
                'about': { title: 'Game Mechanics & Tools Logic', subtitle: 'Understanding the shop tools, mystery box rewards, and Lucky Triples mechanics.' },
                'changelog': { title: 'Game Update Log', subtitle: 'A detailed history of all game versions, features, and fixes.' },
                'database': { title: 'Game Info', subtitle: 'Explore all game modes, difficulty levels, and achievements.' }, // Renamed
            };

            const defaultButtonText = '<i class="fas fa-download mr-2"></i> Download Latest Version';
            const HARDCODED_FILE_SIZE = 'N/A';
            const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));
            const GAME_DATA = JSON.parse(document.getElementById('game-data-json').textContent);

            // --- Modal Functions (Unchanged) ---
            const showDownloadModal = (versionNumber) => {
                document.body.classList.add('modal-open');
                SELECTORS.modalMessage.innerHTML = `The automatic download for version <b>${versionNumber}</b> is starting now. Check your browser's download folder.`;
                SELECTORS.modalBackdrop.classList.remove('opacity-0', 'pointer-events-none');
                SELECTORS.modalContent.classList.remove('scale-90');
                SELECTORS.modalBackdrop.onclick = (e) => {
                    if (e.target.id === 'download-modal-backdrop') {
                        hideDownloadModal();
                    }
                };
            };
            const hideDownloadModal = () => {
                document.body.classList.remove('modal-open');
                SELECTORS.modalBackdrop.classList.add('opacity-0', 'pointer-events-none');
                SELECTORS.modalContent.classList.add('scale-90');
                SELECTORS.modalBackdrop.onclick = null; 
            };
            const showWelcomeModal = (versionNumber) => {
                document.body.classList.add('modal-open');
                SELECTORS.welcomeDownloadButton.innerHTML = `<i class="fas fa-download mr-2"></i> Download ${versionNumber}`;
                SELECTORS.welcomeModalBackdrop.classList.remove('opacity-0', 'pointer-events-none');
                SELECTORS.welcomeModalContent.classList.remove('scale-90');
            };
            const hideWelcomeModal = () => {
                document.body.classList.remove('modal-open');
                SELECTORS.welcomeModalBackdrop.classList.add('opacity-0', 'pointer-events-none');
                SELECTORS.welcomeModalContent.classList.add('scale-90');
            };

            // --- Content Formatting (Unchanged) ---
            const formatContentText = (text, iconType = 'fa-feather') => {
                if (!text) return '<p class="text-red-400">Data content is empty.</p>';
                const lines = text.split('\n').map(line => line.trim()).filter(line => line.length > 0);
                let html = '<ul class="list-none space-y-3 pl-0">';
                lines.forEach(line => {
                    if (line.startsWith('•')) {
                        let content = line.substring(1).trim();
                        content = content.charAt(0).toUpperCase() + content.slice(1);
                        let iconHtml;
                        if (iconType === 'circle') {
                            iconHtml = `<span class="text-link-primary text-xl mr-3 flex-shrink-0 leading-none pt-[2px]">&#9679;</span>`;
                        } else {
                            iconType = iconType === 'fa-feather-alt' ? 'fa-feather-alt' : 'fa-feather';
                            iconHtml = `<span class="text-link-primary text-xl mr-3 flex-shrink-0 leading-none pt-0.5"><i class="fas ${iconType}"></i></span>`;
                        }
                        html += `<li class="flex items-start text-white/90 text-lg">${iconHtml}<span class="block">${content}</span></li>`;
                    } else if (line.endsWith(':')) {
                        html += `<li class="pt-4 pb-1 text-xl font-bold text-button-primary">${line}</li>`;
                    } else if (line.match(/^\d+\./)) {
                        html += `<li class="pt-4 text-xl font-bold text-button-primary">${line}</li>`;
                    } else if (line.length > 0) {
                        html += `<li class="text-white/80 pl-6 text-lg">${line}</li>`;
                    }
                });
                html += '</ul>';
                return html;
            };

            // --- Fetch Logic (Unchanged) ---
            const handleFetchError = (error) => {
                console.error("Failed to fetch master data:", error);
                const failureMessage = `<p class="text-red-400 text-center p-6"><i class="fas fa-exclamation-triangle mr-2"></i> Failed to load data. Please check the console for more details.</p>`;
                SELECTORS.latestVersionHeading.innerHTML = '<i class="fas fa-times-circle mr-3 text-2xl"></i> Load Error';
                SELECTORS.versionContentDiv.innerHTML = failureMessage;
                SELECTORS.whatsNextDiv.innerHTML = failureMessage;
                SELECTORS.downloadButton.disabled = true;
                SELECTORS.downloadButton.classList.add('opacity-50', 'cursor-not-allowed');
                SELECTORS.downloadButton.innerHTML = '<i class="fas fa-times-circle mr-2"></i> Link Error';
                SELECTORS.fileSizeValue.textContent = HARDCODED_FILE_SIZE;
                SELECTORS.downloadCountValue.textContent = 'Error';
                if (SELECTORS.fileStatsPlaceholder && SELECTORS.fileStatsContent) {
                    SELECTORS.fileStatsPlaceholder.classList.add('hidden');
                    SELECTORS.fileStatsContent.classList.remove('hidden');
                }
                SELECTORS.welcomeDownloadButton.disabled = true;
                SELECTORS.welcomeDownloadButton.innerHTML = '<i class="fas fa-times-circle mr-2"></i> Load Error';
                SELECTORS.welcomeDownloadButton.classList.remove('animate-pulse');
            };

            const fetchMasterData = async (url, retries = 3) => {
                for (let i = 0; i < retries; i++) {
                    try {
                        const response = await fetch(url, { cache: "no-store" });
                        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                        return await response.json();
                    } catch (error) {
                        console.error(`Attempt ${i + 1} failed for ${url}.`, error);
                        if (i < retries - 1) await delay(1000 * (2 ** i));
                        else {
                            handleFetchError(error);
                            return null;
                        }
                    }
                }
            };

            // --- Content Population Functions (Unchanged) ---
            const populateHomePage = (data) => {
                try {
                    const versionMatch = data.versionInfo.match(/Game:.*(v[\d.]+)/);
                    const versionNumber = versionMatch ? versionMatch[1] : 'Unknown';
                    
                    // *** FIX: Changed regex to use new RegExp() constructor ***
                    const authorRegex = new RegExp("Author: (.*?)\\s-\\s(https:\\/\\/fillabrona\\.itch\\.io\\/)");
                    const authorLineMatch = data.versionInfo.match(authorRegex);
                    
                    const authorName = authorLineMatch ? authorLineMatch[1] : 'Fillabrona';
                    const authorUrl = authorLineMatch ? authorLineMatch[2] : 'https://fillabrona\.itch\.io/';
                    const fileSize = data.fileSize || HARDCODED_FILE_SIZE; 
                    SELECTORS.versionDisplay.textContent = versionNumber;
                    SELECTORS.authorInfo.innerHTML = `by
                        <a href="${authorUrl}" target="_blank" class="text-link-primary hover:text-white transition duration-200 font-semibold">${authorName}</a>
                    `;
                    SELECTORS.fileSizeValue.textContent = fileSize; 
                    SELECTORS.latestVersionHeading.innerHTML = `<i class="fas fa-tag mr-3 text-2xl"></i> Latest Update`;
                    const updateSection = data.versionInfo.substring(data.versionInfo.indexOf('--- LATEST UPDATE ---') + '--- LATEST UPDATE ---'.length).trim();
                    SELECTORS.versionContentDiv.innerHTML = formatContentText(updateSection, 'fa-feather'); 
                    const roadmapSection = data.whatsNext.substring(data.whatsNext.indexOf('--- UPCOMING FEATURES ---') + '--- UPCOMING FEATURES ---'.length).trim();
                    SELECTORS.whatsNextDiv.innerHTML = formatContentText(roadmapSection, 'circle');
                    SELECTORS.fileStatsPlaceholder.classList.add('hidden');
                    SELECTORS.fileStatsContent.classList.remove('hidden');
                    if (data.downloadLink) {
                        SELECTORS.downloadButton.setAttribute('data-download-url', data.downloadLink);
                        SELECTORS.downloadButton.disabled = false;
                        SELECTORS.downloadButton.classList.remove('opacity-50', 'cursor-not-allowed');
                        SELECTORS.downloadButton.innerHTML = defaultButtonText;
                        SELECTORS.welcomeDownloadButton.classList.remove('animate-pulse');
                        SELECTORS.welcomeDownloadButton.innerHTML = `<i class="fas fa-download mr-2"></i> Download ${versionNumber}`;
                    } else {
                        throw new Error("Download link not found in data.");
                    }
                } catch (processingError) {
                    console.error("Error processing fetched data for homepage:", processingError);
                    handleFetchError(processingError);
                }
            };
            const populateChangelogSection = () => {
				let html = '';
				GAME_DATA.changelog.forEach((entry) => {
					const changes = entry.changes.map((c, index) => {
						let content = c.trim();
						content = content.charAt(0).toUpperCase() + content.slice(1);
						return `
							<div class="changelog-change-block p-4 sm:p-6 rounded-lg shadow-md">
								<h5 class="text-link-primary font-bold mb-1">${entry.changes.length > 1 ? `Update ${index + 1}:` : 'Update:'}</h5>
								<div class="text-white/80 text-lg leading-relaxed">${content}</div>
							</div>
						`;
					});
					const changesContent = `<div class="space-y-4">${changes.join('')}</div>`;
					html += `
						<div class="changelog-entry">
							<div class="changelog-header flex justify-between items-center transition-colors duration-300">
								<div class="flex flex-col sm:flex-row sm:items-baseline">
									<span class="text-button-primary text-xl font-bold mr-4">${entry.version}</span>
								</div>
								<i class="fas fa-chevron-down text-xl text-link-primary transition-transform duration-300"></i>
							</div>
							<div class="changelog-content overflow-hidden" style="max-height: 0;">
								<div class="p-4 sm:p-6 pb-8">
									${changesContent}
								</div>
							</div>
						</div>
					`;
				});
				SELECTORS.contentChangelog.querySelector('#changelog-content').innerHTML = html;
				document.querySelectorAll('.changelog-header').forEach(header => {
					header.addEventListener('click', () => toggleChangelog(header));
				});
			};
			const toggleChangelog = (header) => {
				const entry = header.closest('.changelog-entry');
				const content = entry.querySelector('.changelog-content');
				const icon = header.querySelector('i');
				const isOpen = content.classList.contains('open');
				document.querySelectorAll('.changelog-content.open').forEach(openContent => {
					if (openContent !== content) {
						openContent.style.maxHeight = '0';
						openContent.classList.remove('open');
						openContent.closest('.changelog-entry').querySelector('i').classList.remove('rotated');
					}
				});
				if (isOpen) {
					content.style.maxHeight = '0';
					content.classList.remove('open');
					icon.classList.remove('rotated');
				} else {
					content.style.maxHeight = content.scrollHeight + 50 + 'px'; // +50px buffer
					content.classList.add('open');
					icon.classList.add('rotated');
				}
			};
            
            // === MODIFIED: populateAboutSection ===
            const populateAboutSection = () => {
                let toolsHtml = GAME_DATA.tools.map(tool => `
                    <div class="info-bubble tool-bubble">
                        <h4>
                            <span>${tool.name}</span>
                            <span class="tool-price">${tool.price}</span>
                        </h4>
                        <p class="bubble-description">${tool.description}</p>
                        <p class="tool-cooldown"><i class="fas fa-hourglass-half mr-1"></i> Cooldown: ${tool.cooldown}</p>
                    </div>
                `).join('');
                SELECTORS.toolsContent.innerHTML = toolsHtml;

                let mysteryHtml = '<div class="space-y-4">';
                GAME_DATA.mysteryBox.forEach(item => {
                    const rarityClass = item.rarity.includes('Super rare') ? 'super-rare' : '';
                    mysteryHtml += `
                        <div class="info-bubble reward-bubble">
                            <h4>
                                ${item.item} 
                                <span class="reward-rarity ${rarityClass}">[${item.rarity}]</span>
                            </h4>
                            <p class="bubble-description">${item.howItWorks}</p>
                        </div>
                    `;
                });
                mysteryHtml += '</div>';
                SELECTORS.mysteryBoxContent.innerHTML = mysteryHtml;

                let triplesHtml = '<div class="space-y-4">';
                GAME_DATA.luckyTriples.forEach(item => {
                    triplesHtml += `
                        <div class="info-bubble reward-bubble">
                            <h4>
                                ${item.item} 
                                <span class="reward-rarity">[${item.chance}]</span>
                            </h4>
                            <p class="bubble-description">${item.howItWorks}</p>
                        </div>
                    `;
                });
                triplesHtml += '</div>';
                SELECTORS.luckyTriplesContent.innerHTML = triplesHtml;
            };
            
            // === MODIFIED: populateDatabaseSection ===
            const populateDatabaseSection = () => {
                let modesHtml = GAME_DATA.modes.map(mode => `
                    <div class="info-bubble mode-bubble">
                        <h4><i class="${mode.icon}"></i> ${mode.name} Mode</h4>
                        <p class="bubble-description">${mode.description}</p>
                    </div>
                `).join('');
                SELECTORS.modesContent.innerHTML = modesHtml;

                let difficultiesHtml = GAME_DATA.difficulties.map(diff => `
                    <div class="info-bubble difficulty-bubble">
                        <h4>${diff.name}</h4>
                        <p class="text-white/80 text-sm"><span class="difficulty-score">Score to Win:</span> ${diff.score}</p>
                        <p class="bubble-description">${diff.description}</p>
                    </div>
                `).join('');
                SELECTORS.difficultiesContent.innerHTML = difficultiesHtml;

                let achievementsHtml = GAME_DATA.achievements.map(ach => `
                    <div class="info-bubble achievement-bubble">
                        <div class="achievement-header">
                            <i class="${ach.icon}"></i>
                            <h4>${ach.name}</h4>
                        </div>
                        <p class="bubble-subtitle">${ach.subtitle}</p>
                        <p class="bubble-description">${ach.description}</p>
                    </div>
                `).join('');
                SELECTORS.achievementsContent.innerHTML = achievementsHtml;
            };
            
            // --- Routing Logic (MODIFIED) ---
            const switchSection = (sectionId) => {
                // MODIFIED: Added contentReviews
                const sections = [
                    SELECTORS.contentHome, 
                    SELECTORS.contentReviews, 
                    SELECTORS.contentAbout, 
                    SELECTORS.contentChangelog, 
                    SELECTORS.contentDatabase
                ];
                const activeSection = document.getElementById(`content-${sectionId}`);
                
                SELECTORS.content404.style.display = 'none';
                SELECTORS.siteNav.classList.remove('hidden');
                SELECTORS.siteHeader.classList.remove('hidden');
                SELECTORS.mainPageWrapper.classList.remove('hidden');
                document.body.classList.remove('modal-open'); 

                if (!activeSection || !VALID_SECTIONS.includes(sectionId)) {
                    // This is the 404 logic. It will no longer trigger for 'reviews'
                    // because VALID_SECTIONS is correct.
                    // *** FIX: Check if section exists before adding 'hidden' ***
                    sections.forEach(sec => {
                        if (sec) sec.classList.add('hidden');
                    });
                    SELECTORS.content404.style.display = 'flex';
                    SELECTORS.siteNav.classList.add('hidden');
                    SELECTORS.siteHeader.classList.add('hidden');
                    SELECTORS.mainPageWrapper.classList.add('hidden');
                    document.body.classList.add('modal-open'); 
                    SELECTORS.lottie404.src = LOTTIE_404_URL;
                    SELECTORS.pageTitle.textContent = '404 - Page Not Found';
                    SELECTORS.homeLink404.onclick = (e) => {
                        e.preventDefault();
                        window.history.pushState(null, null, '#section=home');
                        handleRouting();
                    };
                    return;
                }

                // *** FIX: Check if section exists before adding 'hidden' ***
                sections.forEach(sec => {
                    if (sec) sec.classList.add('hidden');
                });
                document.getElementById(`content-${sectionId}`).classList.remove('hidden');

                SELECTORS.navLinks.forEach(link => {
                    const linkSection = link.getAttribute('data-section');
                    const icon = link.querySelector('i');
                    if (linkSection === sectionId) {
                        link.classList.add('active');
                        if(icon) icon.classList.remove('text-link-primary');
                    } else {
                        link.classList.remove('active');
                        if(icon) icon.classList.add('text-link-primary');
                    }
                });

                const currentTitle = SECTION_TITLES[sectionId] || SECTION_TITLES['home'];
                
                SELECTORS.heroTitle.textContent = currentTitle.title;
                SELECTORS.heroSubtitle.textContent = currentTitle.subtitle;

                if (sectionId !== 'home') {
                    SELECTORS.heroTitle.classList.remove('sm:text-7xl'); // Use sm:text-7xl from home
                    SELECTORS.heroTitle.classList.add('text-5xl', 'sm:text-7xl'); // Keep text-5xl for mobile
                    SELECTORS.heroSubtitle.classList.remove('sm:text-3xl');
                    SELECTORS.heroSubtitle.classList.add('sm:text-2xl');
                } else {
                    // This is for 'home'
                    SELECTORS.heroTitle.classList.remove('text-5xl'); // Remove mobile override
                    SELECTORS.heroTitle.classList.add('sm:text-7xl'); // Add/keep desktop size
                    SELECTORS.heroSubtitle.classList.remove('sm:text-2xl');
                    SELECTORS.heroSubtitle.classList.add('sm:text-3xl');
                }
                
                SELECTORS.pageTitle.textContent = currentTitle.title + ' - Quiz for Survival';

                if (SELECTORS.navMenu && SELECTORS.navMenu.classList.contains('open') && window.innerWidth < 640) {
                    SELECTORS.navMenu.classList.remove('open');
                    SELECTORS.menuIcon.classList.remove('fa-times');
                    SELECTORS.menuIcon.classList.add('fa-bars');
                }
            };

            // --- Download Logic (Unchanged) ---
            const startDownload = async (button, isWelcomeModal = false) => {
                const downloadUrl = SELECTORS.downloadButton.getAttribute('data-download-url'); 
                
                if (downloadUrl && !button.disabled) {
                    button.disabled = true;
                    button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Starting Download...';
                    
                    // Increment Firestore download count
                    await incrementDownloadCount();

                    if (isWelcomeModal) hideWelcomeModal();

                    setTimeout(() => {
                        const versionNumber = SELECTORS.versionDisplay.textContent || 'Unknown';
                        showDownloadModal(versionNumber);
                        window.location.href = downloadUrl;
                        
                        setTimeout(() => {
                            button.disabled = false;
                            let newText = defaultButtonText;
                            if (button.id === 'welcome-download-button') {
                                newText = `<i class="fas fa-download mr-2"></i> Download ${versionNumber}`;
                            }
                            button.innerHTML = newText;
                        }, 1500);
                    }, 500);
                }
            };
            
            // --- Routing (Unchanged) ---
            const handleRouting = () => {
                const hash = window.location.hash.substring(1); 
                const params = new URLSearchParams(hash);
                let section = params.get('section') || 'home';
                let action = params.get('action'); 
                
                const shouldAutoDownload = action === 'download' && SELECTORS.downloadButton.getAttribute('data-download-url');

                if (shouldAutoDownload) {
                    const newHash = window.location.hash.split('&').filter(p => !p.includes('action=download')).join('&');
                    window.history.replaceState(null, null, newHash || '#section=home');
                    startDownload(SELECTORS.downloadButton); 
                }

                switchSection(section);

                if (window.innerWidth < 768 && section !== 'home' && VALID_SECTIONS.includes(section)) {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            };


            // --- Initialization ---
            const setupDownloadHandler = (versionNumber) => {
                SELECTORS.modalCloseButton.addEventListener('click', hideDownloadModal);
                SELECTORS.downloadButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    startDownload(SELECTORS.downloadButton);
                });
                SELECTORS.welcomeDownloadButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    startDownload(SELECTORS.welcomeDownloadButton, true);
                });
                SELECTORS.welcomeContinueButton.addEventListener('click', hideWelcomeModal);
            };

            const initializePage = async () => {
                
                // Initialize BOTH Firebase apps
                SELECTORS.downloadCountValue.textContent = 'Loading...';
                SELECTORS.fileSizeValue.textContent = HARDCODED_FILE_SIZE;
                
                await initializeFirebase();
                
                // Start BOTH listeners
                startDownloadListener(); // For Firestore downloads
                startReviewListener();   // For RTDB reviews

                const hash = window.location.hash.substring(1); 
                const params = new URLSearchParams(hash);
                const isAutoDownloadRequest = params.get('action') === 'download';

                populateChangelogSection();
                populateAboutSection();
                populateDatabaseSection();

                SELECTORS.downloadButton.disabled = true;
                const data = await fetchMasterData(URLS.masterData);
                
                let versionNumber = 'Unknown';

                if (data) {
                    populateHomePage(data);
                    const versionMatch = data.versionInfo.match(/Game:.*(v[\d.]+)/);
                    versionNumber = versionMatch ? versionMatch[1] : 'Unknown';
                    setupDownloadHandler(versionNumber);
                }

                window.addEventListener('hashchange', handleRouting);
                handleRouting(); 

                if (data && !isAutoDownloadRequest) {
                    await delay(300); 
                    showWelcomeModal(versionNumber);
                }

                if (SELECTORS.menuButton) {
                    SELECTORS.menuButton.addEventListener('click', () => {
                        const isOpen = SELECTORS.navMenu.classList.toggle('open');
                        SELECTORS.menuIcon.classList.toggle('fa-bars', !isOpen);
                        SELECTORS.menuIcon.classList.toggle('fa-times', isOpen);
                    });
                }

                // NEW: Global click listener for review like buttons
                document.body.addEventListener('click', (e) => {
                    const likeButton = e.target.closest('.like-button');
                    if (likeButton) {
                        e.preventDefault();
                        const reviewId = likeButton.getAttribute('data-review-id');
                        if (reviewId) {
                            incrementReviewLike(reviewId);
                        }
                    }
                });
            };

            initializePage();
        });
    </script>

</body>
</html>
